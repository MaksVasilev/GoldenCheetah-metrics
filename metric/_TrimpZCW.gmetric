<usermetrics version="1">
	<usermetric symbol="_TrimpZCW" name="_TrimpZCW" description="Центровзвешенный TRIMP с весовыми коэффициентами по зонам." unitsMetric="TRIMP баллы" unitsImperial="TRIMP баллы" aggzero="1" istime="0" precision="0" type="0" conversion="1" conversionSum="0" fingerprint="_TrimpZCW{value{dHR&lt;-(Average_Heart_Rate-config(rhr))/(config(maxhr)-config(rhr));b1&lt;-1.92;b2&lt;-0.64;kz1&lt;-0.595;kz2&lt;-0.777;kz3&lt;-0.979;kz4&lt;-1.201;kz5&lt;-1.447;if(Sport=&quot;Run&quot;||Sport=&quot;Treadmill&quot;){kz1&lt;-0.459;kz2&lt;-0.696;kz3&lt;-0.964;kz4&lt;-1.268;kz5&lt;-1.612;}if(Sport=&quot;Swim&quot;){kz1&lt;-0.432;kz2&lt;-0.680;kz3&lt;-0.962;kz4&lt;-1.282;kz5&lt;-1.644;}if(Sport=&quot;Ski&quot;||Sport=&quot;Ice&quot;){kz1&lt;-0.387;kz2&lt;-0.656;kz3&lt;-0.959;kz4&lt;-1.304;kz5&lt;-1.694;}base&lt;-((Time_Recording/60)*dHR*b2*exp(b1*dHR))/(100.0);trimp_zcw&lt;-(base*H1_Percent_in_Zone*kz1)+(base*H2_Percent_in_Zone*kz2)+(base*H3_Percent_in_Zone*kz3)+(base*H4_Percent_in_Zone*kz4)+(base*H5_Percent_in_Zone*kz5);if((Max_Heartrate)=0){trimp_zcw&lt;-base*100.0;}trimp_zcw;}}" >
{    \n    value {\n		# резерв ЧСС\n        dHR &lt;- (Average_Heart_Rate-config(rhr))/(config(maxhr)-config(rhr));\n		## резерв максимального ЧСС для бонуса\n		##dHRmax &lt;- (Max_Heartrate-config(rhr))/(config(maxhr)-config(rhr));\n\n		# коэффициент лактата\n        b1 &lt;- 1.92; # for Man or b1&lt;-1.67 for Woman, no config(sex) for now\n		b2 &lt;- 0.64; # for Man or b2&lt;-0.86 for Woman, no config(sex) for now\n\n		# весовые коэффициенты зон\n		# велосипед, велотренажёр и по умолчанию\n		kz1 &lt;- 0.595; kz2 &lt;- 0.777; kz3 &lt;- 0.979; kz4 &lt;- 1.201; kz5 &lt;- 1.447;\n\n		if (Sport = &quot;Run&quot; || Sport = &quot;Treadmill&quot;) { kz1 &lt;- 0.459; kz2 &lt;- 0.696; kz3 &lt;- 0.964; kz4 &lt;- 1.268; kz5 &lt;- 1.612; }\n		if (Sport = &quot;Swim&quot;) { kz1 &lt;- 0.432; kz2 &lt;- 0.680; kz3 &lt;- 0.962; kz4 &lt;- 1.282; kz5 &lt;- 1.644; }\n		if (Sport = &quot;Ski&quot; || Sport = &quot;Ice&quot;) { kz1 &lt;- 0.387; kz2 &lt;- 0.656; kz3 &lt;- 0.959; kz4 &lt;- 1.304; kz5 &lt;- 1.694; }\n\n		# база TRIMP\n        base &lt;- ((Time_Recording/60) * dHR * b2 * exp(b1*dHR))/(100.0);\n\n		# сумма частей TRIMP по зонам\n		trimp_zcw &lt;- (base * H1_Percent_in_Zone * kz1) + (base * H2_Percent_in_Zone * kz2) + (base * H3_Percent_in_Zone * kz3) + (base * H4_Percent_in_Zone * kz4) + (base * H5_Percent_in_Zone * kz5);\n\n		if ( (Max_Heartrate) = 0)	{ trimp_zcw &lt;- base * 100.0; } \n\n		trimp_zcw;\n	}\n}
</usermetric>
</usermetrics>
